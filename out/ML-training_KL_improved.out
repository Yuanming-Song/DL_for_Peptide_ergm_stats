no change     /opt/apps/anaconda/2024.06/condabin/conda
no change     /opt/apps/anaconda/2024.06/bin/conda
no change     /opt/apps/anaconda/2024.06/bin/conda-env
no change     /opt/apps/anaconda/2024.06/bin/activate
no change     /opt/apps/anaconda/2024.06/bin/deactivate
no change     /opt/apps/anaconda/2024.06/etc/profile.d/conda.sh
no change     /opt/apps/anaconda/2024.06/etc/fish/conf.d/conda.fish
no change     /opt/apps/anaconda/2024.06/shell/condabin/Conda.psm1
no change     /opt/apps/anaconda/2024.06/shell/condabin/conda-hook.ps1
no change     /opt/apps/anaconda/2024.06/lib/python3.12/site-packages/xontrib/conda.xsh
no change     /opt/apps/anaconda/2024.06/etc/profile.d/conda.csh
no change     /data/homezvol3/yuanmis1/.bashrc
No action taken.
Raw train labels: 0    0.135036496350365,0.14963503649635,0.086678832...
1    0.00478468899521531,0.050580997949419,0.408065...
2    0,0,0.246865203761755,0.524294670846395,0.2288...
3    0.00748299319727891,0.00136054421768707,0.1693...
4    0.0645161290322581,0.162903225806452,0.1177419...
Name: Label, dtype: object
Raw valid labels: 0    0,0.0175131348511384,0.182136602451839,0.35989...
1    0,0.023876404494382,0.141151685393258,0.693117...
2    0.131656804733728,0,0.267011834319527,0.446005...
3    0,0,0,0.745310957551826,0.107601184600197,0.14...
4    0.0717875089734386,0.24934194783441,0.43359655...
Name: Label, dtype: object
Raw test labels: 0          0,0,0,0,0.730232558139535,0.269767441860465
1    0.245145631067961,0,0,0.298543689320388,0.2257...
2    0,0,0.385286783042394,0,0.613466334164589,0.00...
3          0,0,0,0.820683903252711,0.179316096747289,0
4    0.421290322580645,0.213225806451613,0.14,0.110...
Name: Label, dtype: object
Processed train labels: tensor([[1.3504e-01, 1.4964e-01, 8.6679e-02, 2.7281e-01, 2.6734e-01, 8.8504e-02],
        [4.7847e-03, 5.0581e-02, 4.0807e-01, 1.5038e-01, 3.6774e-01, 1.8455e-02],
        [2.0000e-08, 2.0000e-08, 2.4687e-01, 5.2429e-01, 2.2884e-01, 2.0000e-08],
        [7.4830e-03, 1.3606e-03, 1.6939e-01, 4.5918e-01, 3.6190e-01, 6.8029e-04],
        [6.4516e-02, 1.6290e-01, 1.1774e-01, 4.8871e-01, 6.4516e-03, 1.5968e-01]])
Processed valid labels: tensor([[2.0000e-08, 1.7513e-02, 1.8214e-01, 3.5989e-01, 3.7653e-01, 6.3923e-02],
        [2.0000e-08, 2.3876e-02, 1.4115e-01, 6.9312e-01, 1.4115e-01, 7.0227e-04],
        [1.3166e-01, 2.0000e-08, 2.6701e-01, 4.4601e-01, 6.5089e-02, 9.0237e-02],
        [2.0000e-08, 2.0000e-08, 2.0000e-08, 7.4531e-01, 1.0760e-01, 1.4709e-01],
        [7.1788e-02, 2.4934e-01, 4.3360e-01, 2.3187e-01, 1.3400e-02, 2.0000e-08]],
       device='cuda:0')
Processed test labels: tensor([[2.0000e-08, 2.0000e-08, 2.0000e-08, 2.0000e-08, 7.3023e-01, 2.6977e-01],
        [2.4515e-01, 2.0000e-08, 2.0000e-08, 2.9854e-01, 2.2573e-01, 2.3058e-01],
        [2.0000e-08, 2.0000e-08, 3.8529e-01, 2.0000e-08, 6.1347e-01, 1.2469e-03],
        [2.0000e-08, 2.0000e-08, 2.0000e-08, 8.2068e-01, 1.7932e-01, 2.0000e-08],
        [4.2129e-01, 2.1323e-01, 1.4000e-01, 1.1032e-01, 1.0161e-01, 1.3548e-02]],
       device='cuda:0')
Epoch 1/100:
  Train Loss: 0.529278
  Valid KL: 0.529485
  Avg Gradient Norm: 0.082782
  Avg Parameter Norm: 97.036758
  Learning Rate: 0.000018
  ---
Saved best model with Valid KL: 0.529485 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 2/100:
  Train Loss: 0.505604
  Valid KL: 0.481818
  Avg Gradient Norm: 0.104129
  Avg Parameter Norm: 97.055588
  Learning Rate: 0.000036
  ---
Saved best model with Valid KL: 0.481818 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 3/100:
  Train Loss: 0.464969
  Valid KL: 0.454337
  Avg Gradient Norm: 0.107503
  Avg Parameter Norm: 97.106026
  Learning Rate: 0.000054
  ---
Saved best model with Valid KL: 0.454337 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 4/100:
  Train Loss: 0.449041
  Valid KL: 0.448288
  Avg Gradient Norm: 0.100788
  Avg Parameter Norm: 97.134399
  Learning Rate: 0.000072
  ---
Saved best model with Valid KL: 0.448288 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 5/100:
  Train Loss: 0.444949
  Valid KL: 0.446715
  Avg Gradient Norm: 0.111552
  Avg Parameter Norm: 97.165863
  Learning Rate: 0.000090
  ---
Saved best model with Valid KL: 0.446715 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 6/100:
  Train Loss: 0.442500
  Valid KL: 0.444249
  Avg Gradient Norm: 0.109477
  Avg Parameter Norm: 97.207909
  Learning Rate: 0.000100
  ---
Saved best model with Valid KL: 0.444249 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 7/100:
  Train Loss: 0.440164
  Valid KL: 0.444888
  Avg Gradient Norm: 0.113307
  Avg Parameter Norm: 97.249481
  Learning Rate: 0.000099
  ---
Epoch 8/100:
  Train Loss: 0.438652
  Valid KL: 0.443051
  Avg Gradient Norm: 0.122323
  Avg Parameter Norm: 97.283211
  Learning Rate: 0.000097
  ---
Saved best model with Valid KL: 0.443051 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 9/100:
  Train Loss: 0.436763
  Valid KL: 0.439657
  Avg Gradient Norm: 0.125185
  Avg Parameter Norm: 97.312508
  Learning Rate: 0.000096
  ---
Saved best model with Valid KL: 0.439657 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 10/100:
  Train Loss: 0.434654
  Valid KL: 0.437717
  Avg Gradient Norm: 0.132145
  Avg Parameter Norm: 97.351692
  Learning Rate: 0.000095
  ---
Saved best model with Valid KL: 0.437717 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 11/100:
  Train Loss: 0.432665
  Valid KL: 0.437109
  Avg Gradient Norm: 0.131228
  Avg Parameter Norm: 97.393402
  Learning Rate: 0.000094
  ---
Saved best model with Valid KL: 0.437109 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 12/100:
  Train Loss: 0.430852
  Valid KL: 0.435626
  Avg Gradient Norm: 0.138760
  Avg Parameter Norm: 97.437904
  Learning Rate: 0.000093
  ---
Saved best model with Valid KL: 0.435626 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 13/100:
  Train Loss: 0.429549
  Valid KL: 0.433985
  Avg Gradient Norm: 0.142031
  Avg Parameter Norm: 97.476646
  Learning Rate: 0.000092
  ---
Saved best model with Valid KL: 0.433985 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 14/100:
  Train Loss: 0.428751
  Valid KL: 0.434576
  Avg Gradient Norm: 0.143062
  Avg Parameter Norm: 97.513596
  Learning Rate: 0.000091
  ---
Epoch 15/100:
  Train Loss: 0.427985
  Valid KL: 0.433274
  Avg Gradient Norm: 0.144500
  Avg Parameter Norm: 97.553535
  Learning Rate: 0.000090
  ---
Saved best model with Valid KL: 0.433274 at /dfs9/tw/yuanmis1/mrsec/ML-MD-Peptide/DL_for_Peptide/Transformer_KL_rebin_best_improved.pt
Epoch 16/100:
  Train Loss: 0.426907
  Valid KL: 0.435089
  Avg Gradient Norm: 0.147823
  Avg Parameter Norm: 97.592278
  Learning Rate: 0.000089
  ---
Epoch 17/100:
  Train Loss: 0.426357
  Valid KL: 0.434874
  Avg Gradient Norm: 0.153745
  Avg Parameter Norm: 97.632133
  Learning Rate: 0.000088
  ---
Epoch 18/100:
  Train Loss: 0.426205
  Valid KL: 0.434357
  Avg Gradient Norm: 0.159506
  Avg Parameter Norm: 97.670326
  Learning Rate: 0.000087
  ---
Epoch 19/100:
  Train Loss: 0.425061
  Valid KL: 0.434873
  Avg Gradient Norm: 0.157996
  Avg Parameter Norm: 97.712448
  Learning Rate: 0.000086
  ---
Epoch 20/100:
  Train Loss: 0.424229
  Valid KL: 0.435086
  Avg Gradient Norm: 0.161205
  Avg Parameter Norm: 97.754860
  Learning Rate: 0.000085
  ---
Epoch 21/100:
  Train Loss: 0.423557
  Valid KL: 0.434566
  Avg Gradient Norm: 0.169892
  Avg Parameter Norm: 97.798683
  Learning Rate: 0.000084
  ---
Epoch 22/100:
  Train Loss: 0.422662
  Valid KL: 0.435418
  Avg Gradient Norm: 0.163930
  Avg Parameter Norm: 97.844215
  Learning Rate: 0.000083
  ---
Epoch 23/100:
  Train Loss: 0.421721
  Valid KL: 0.436634
  Avg Gradient Norm: 0.173350
  Avg Parameter Norm: 97.890709
  Learning Rate: 0.000082
  ---
Epoch 24/100:
  Train Loss: 0.420975
  Valid KL: 0.437234
  Avg Gradient Norm: 0.176440
  Avg Parameter Norm: 97.938271
  Learning Rate: 0.000080
  ---
Epoch 25/100:
  Train Loss: 0.420073
  Valid KL: 0.436352
  Avg Gradient Norm: 0.178325
  Avg Parameter Norm: 97.994560
  Learning Rate: 0.000079
  ---
Early stopping triggered after 25 epochs
Test KL Divergence: 0.434062
